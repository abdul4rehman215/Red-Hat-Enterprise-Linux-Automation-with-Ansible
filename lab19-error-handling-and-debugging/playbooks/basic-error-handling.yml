---
- name: Basic Error Handling Demonstration
  hosts: webservers
  become: yes

  tasks:
    - name: Task that might fail - without error handling
      command: /bin/false
      register: result_without_handling
      ignore_errors: yes

    - name: Display result of failed task
      debug:
        msg: "Previous task failed with return code: {{ result_without_handling.rc }}"

    - name: Attempt to install non-existent package
      yum:
        name: non-existent-package-12345
        state: present
      ignore_errors: yes
      register: package_result

    - name: Handle package installation failure
      debug:
        msg: "Package installation failed: {{ package_result.msg }}"
      when: package_result.failed

    - name: Continue with other tasks
      debug:
        msg: "This task runs even after previous failures"

    - name: Conditional error handling
      shell: "ls /nonexistent/directory"
      ignore_errors: yes
      register: ls_result
      changed_when: false

    - name: Report directory listing result
      debug:
        msg: "Directory listing {{ 'succeeded' if ls_result.rc == 0 else 'failed' }}"
