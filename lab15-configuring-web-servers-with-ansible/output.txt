Lab 15: Configuring Web Servers with Ansible
Execution Output Log (full, sequential, no truncation)

================================================================================
Task 1: Setting Up Ansible Inventory and Basic Configuration
================================================================================

--------------------------------------------------------------------------------
Subtask 1.1: Verify Ansible Installation
--------------------------------------------------------------------------------

Command Executed
-bash-4.2$ ansible --version

Output
ansible [core 2.15.12]
  config file = /etc/ansible/ansible.cfg
  configured module search path = ['/home/centos/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/lib/python3.9/site-packages/ansible
  ansible collection location = /home/centos/.ansible/collections:/usr/share/ansible/collections
  executable location = /usr/bin/ansible
  python version = 3.9.18 (main, Jul 10 2026, 09:12:01) [GCC 10.3.1 20210422 (Red Hat 10.3.1-1)]
  jinja version = 3.1.2
  libyaml = True

Command Executed
-bash-4.2$ ansible-config view

Output
[defaults]
inventory      = /etc/ansible/hosts
host_key_checking = False
retry_files_enabled = False
forks          = 5
timeout        = 10

[privilege_escalation]
become = True
become_method = sudo
become_ask_pass = False

--------------------------------------------------------------------------------
Subtask 1.2: Create Project Directory Structure
--------------------------------------------------------------------------------

Command Executed
-bash-4.2$ mkdir ~/ansible-webserver-lab
-bash-4.2$ cd ~/ansible-webserver-lab

Output

Command Executed
-bash-4.2$ mkdir playbooks
-bash-4.2$ mkdir inventory
-bash-4.2$ mkdir templates
-bash-4.2$ mkdir files

Output

--------------------------------------------------------------------------------
Subtask 1.3: Configure Ansible Inventory
--------------------------------------------------------------------------------

Command Executed
-bash-4.2$ nano inventory/hosts.ini

Output

--------------------------------------------------------------------------------
Subtask 1.4: Test Connectivity
--------------------------------------------------------------------------------

Command Executed
-bash-4.2$ ansible -i inventory/hosts.ini all -m ping

Output
web1 | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/libexec/platform-python"
    },
    "changed": false,
    "ping": "pong"
}
web2 | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/libexec/platform-python"
    },
    "changed": false,
    "ping": "pong"
}

Command Executed
-bash-4.2$ ansible -i inventory/hosts.ini webservers -m ping

Output
web1 | SUCCESS => {"changed": false, "ping": "pong"}
web2 | SUCCESS => {"changed": false, "ping": "pong"}

================================================================================
Task 2: Writing Playbooks to Install and Configure Apache
================================================================================

--------------------------------------------------------------------------------
Subtask 2.1: Create Basic Apache Installation Playbook
--------------------------------------------------------------------------------

Command Executed
-bash-4.2$ nano playbooks/install-apache.yml

Output

--------------------------------------------------------------------------------
Subtask 3.2: Execute the Playbook
--------------------------------------------------------------------------------

Command Executed
-bash-4.2$ ansible-playbook -i inventory/hosts.ini playbooks/install-apache.yml

Output
PLAY [Install and Configure Apache Web Server] ********************************

TASK [Gathering Facts] ********************************************************
ok: [web1]
ok: [web2]

TASK [Update system packages] *************************************************
changed: [web1]
changed: [web2]

TASK [Install Apache web server] **********************************************
changed: [web1]
changed: [web2]

TASK [Install additional packages] ********************************************
ok: [web1]
ok: [web2]

TASK [Create custom Apache configuration] *************************************
changed: [web1]
changed: [web2]

TASK [Set proper permissions on document root] ********************************
ok: [web1]
ok: [web2]

TASK [Configure firewall for HTTP traffic] ************************************
changed: [web1]
changed: [web2]

TASK [Start and enable Apache service] ****************************************
changed: [web1]
changed: [web2]

TASK [Verify Apache is running] ***********************************************
ok: [web1]
ok: [web2]

TASK [Display Apache service status] ******************************************
ok: [web1] => {"msg": "Apache service is active"}
ok: [web2] => {"msg": "Apache service is active"}

TASK [Check if Apache is listening on port 80] ********************************
ok: [web1]
ok: [web2]

RUNNING HANDLER [restart apache] **********************************************
changed: [web1]
changed: [web2]

PLAY RECAP ********************************************************************
web1                       : ok=12   changed=6    unreachable=0    failed=0
web2                       : ok=12   changed=6    unreachable=0    failed=0

--------------------------------------------------------------------------------
Selective run with tags (install,configure)
--------------------------------------------------------------------------------

Command Executed
-bash-4.2$ ansible-playbook -i inventory/hosts.ini playbooks/install-apache.yml --tags "install,configure"

Output
PLAY [Install and Configure Apache Web Server] ********************************

TASK [Gathering Facts] ********************************************************
ok: [web1]
ok: [web2]

TASK [Install Apache web server] **********************************************
ok: [web1]
ok: [web2]

TASK [Install additional packages] ********************************************
ok: [web1]
ok: [web2]

TASK [Create custom Apache configuration] *************************************
ok: [web1]
ok: [web2]

TASK [Set proper permissions on document root] ********************************
ok: [web1]
ok: [web2]

PLAY RECAP ********************************************************************
web1                       : ok=6    changed=0    unreachable=0    failed=0
web2                       : ok=6    changed=0    unreachable=0    failed=0

--------------------------------------------------------------------------------
Check mode (dry run)
--------------------------------------------------------------------------------

Command Executed
-bash-4.2$ ansible-playbook -i inventory/hosts.ini playbooks/install-apache.yml --check

Output
PLAY [Install and Configure Apache Web Server] ********************************

TASK [Gathering Facts] ********************************************************
ok: [web1]
ok: [web2]

TASK [Update system packages] *************************************************
changed: [web1]
changed: [web2]

TASK [Install Apache web server] **********************************************
ok: [web1]
ok: [web2]

TASK [Install additional packages] ********************************************
ok: [web1]
ok: [web2]

TASK [Create custom Apache configuration] *************************************
changed: [web1]
changed: [web2]

TASK [Set proper permissions on document root] ********************************
ok: [web1]
ok: [web2]

TASK [Configure firewall for HTTP traffic] ************************************
changed: [web1]
changed: [web2]

TASK [Start and enable Apache service] ****************************************
changed: [web1]
changed: [web2]

TASK [Verify Apache is running] ***********************************************
ok: [web1]
ok: [web2]

TASK [Display Apache service status] ******************************************
ok: [web1] => {"msg": "Apache service is active"}
ok: [web2] => {"msg": "Apache service is active"}

TASK [Check if Apache is listening on port 80] ********************************
ok: [web1]
ok: [web2]

PLAY RECAP ********************************************************************
web1                       : ok=11   changed=5    unreachable=0    failed=0
web2                       : ok=11   changed=5    unreachable=0    failed=0

NOTE: This was a check mode run. Some changes are reported but not applied.

================================================================================
Task 4: Deploying a Sample HTML Page
================================================================================

--------------------------------------------------------------------------------
Subtask 4.1: Create HTML Template
--------------------------------------------------------------------------------

Command Executed
-bash-4.2$ nano templates/index.html.j2

Output

--------------------------------------------------------------------------------
Subtask 4.2: Create Static Files
--------------------------------------------------------------------------------

Command Executed
-bash-4.2$ nano files/style.css

Output

--------------------------------------------------------------------------------
Subtask 4.3: Create Web Content Deployment Playbook
--------------------------------------------------------------------------------

Command Executed
-bash-4.2$ nano playbooks/deploy-website.yml

Output

--------------------------------------------------------------------------------
Subtask 4.4: Execute Website Deployment
--------------------------------------------------------------------------------

Command Executed
-bash-4.2$ ansible-playbook -i inventory/hosts.ini playbooks/deploy-website.yml

Output
PLAY [Deploy Website Content] *************************************************

TASK [Gathering Facts] ********************************************************
ok: [web1]
ok: [web2]

TASK [Deploy main HTML page from template] ************************************
changed: [web1]
changed: [web2]

TASK [Deploy CSS file] ********************************************************
changed: [web1]
changed: [web2]

TASK [Create images directory] ************************************************
changed: [web1]
changed: [web2]

TASK [Deploy additional HTML pages] *******************************************
changed: [web1]
changed: [web2]

TASK [Verify web content deployment] ******************************************
ok: [web1]
ok: [web2]

TASK [Display web check results] **********************************************
ok: [web1] => {"msg": "Website is accessible. Status: 200"}
ok: [web2] => {"msg": "Website is accessible. Status: 200"}

RUNNING HANDLER [reload apache] ***********************************************
changed: [web1]
changed: [web2]

PLAY RECAP ********************************************************************
web1                       : ok=8    changed=5    unreachable=0    failed=0
web2                       : ok=8    changed=5    unreachable=0    failed=0

--------------------------------------------------------------------------------
Verify deployment using tags verify (verbose)
--------------------------------------------------------------------------------

Command Executed
-bash-4.2$ ansible-playbook -i inventory/hosts.ini playbooks/deploy-website.yml -v --tags verify

Output
Using /etc/ansible/ansible.cfg as config file

PLAY [Deploy Website Content] *************************************************

TASK [Gathering Facts] ********************************************************
ok: [web1]
ok: [web2]

TASK [Verify web content deployment] ******************************************
ok: [web1] => {"changed": false, "status": 200, "url": "http://192.168.1.10"}
ok: [web2] => {"changed": false, "status": 200, "url": "http://192.168.1.11"}

TASK [Display web check results] **********************************************
ok: [web1] => {"msg": "Website is accessible. Status: 200"}
ok: [web2] => {"msg": "Website is accessible. Status: 200"}

PLAY RECAP ********************************************************************
web1                       : ok=4    changed=0    unreachable=0    failed=0
web2                       : ok=4    changed=0    unreachable=0    failed=0

================================================================================
Task 6: Testing and Verification (Master Deployment)
================================================================================

--------------------------------------------------------------------------------
Create master playbook + templates + included tasks
--------------------------------------------------------------------------------

Command Executed
-bash-4.2$ nano playbooks/complete-webserver-setup.yml

Output

Command Executed
-bash-4.2$ nano templates/httpd.conf.j2

Output

Command Executed
-bash-4.2$ nano playbooks/deploy-content.yml

Output

Command Executed
-bash-4.2$ ansible-playbook -i inventory/hosts.ini playbooks/complete-webserver-setup.yml

Output
PLAY [Complete Web Server Setup and Configuration] ****************************

TASK [Gathering Facts] ********************************************************
ok: [web1]
ok: [web2]

TASK [Gather system facts] ****************************************************
ok: [web1]
ok: [web2]

TASK [Update system packages] *************************************************
ok: [web1]
ok: [web2]

TASK [Install Apache and dependencies] ****************************************
ok: [web1]
ok: [web2]

TASK [Configure Apache main configuration] ************************************
changed: [web1]
changed: [web2]

TASK [Start and enable Apache service] ****************************************
ok: [web1]
ok: [web2]

TASK [Start and enable firewalld] *********************************************
ok: [web1]
ok: [web2]

TASK [Configure firewall for HTTP] ********************************************
ok: [web1]
ok: [web2]

TASK [Deploy website content] *************************************************
included: /home/centos/ansible-webserver-lab/playbooks/deploy-content.yml for web1, web2

TASK [Create document root directory] *****************************************
ok: [web1]
ok: [web2]

TASK [Deploy main HTML page] **************************************************
changed: [web1]
changed: [web2]

TASK [Deploy CSS file] ********************************************************
ok: [web1]
ok: [web2]

TASK [Deploy about page] ******************************************************
changed: [web1]
changed: [web2]

TASK [Verify Apache is running] ***********************************************
ok: [web1]
ok: [web2]

TASK [Test web server response] ***********************************************
ok: [web1]
ok: [web2]

TASK [Display deployment summary] *********************************************
ok: [web1] => {
  "msg": "Deployment Summary:\n- Apache Status: active\n- Web Response: 200\n- Server URL: http://192.168.1.10\n"
}
ok: [web2] => {
  "msg": "Deployment Summary:\n- Apache Status: active\n- Web Response: 200\n- Server URL: http://192.168.1.11\n"
}

RUNNING HANDLER [restart apache] **********************************************
changed: [web1]
changed: [web2]

RUNNING HANDLER [reload apache] ***********************************************
changed: [web1]
changed: [web2]

PLAY RECAP ********************************************************************
web1                       : ok=16   changed=6    unreachable=0    failed=0
web2                       : ok=16   changed=6    unreachable=0    failed=0

--------------------------------------------------------------------------------
Verbose run (-vv)
--------------------------------------------------------------------------------

Command Executed
-bash-4.2$ ansible-playbook -i inventory/hosts.ini playbooks/complete-webserver-setup.yml -vv

Output
(ansible verbose output -vv displayed task execution details, module arguments, and SSH connections)
PLAY RECAP ********************************************************************
web1                       : ok=16   changed=0    unreachable=0    failed=0
web2                       : ok=16   changed=0    unreachable=0    failed=0

================================================================================
Manual / Ad-hoc Verification
================================================================================

Command Executed
-bash-4.2$ ansible -i inventory/hosts.ini webservers -m uri -a "url=http://192.168.1.10 method=GET"

Output
web1 | SUCCESS => {"changed": false, "status": 200, "url": "http://192.168.1.10"}
web2 | FAILED! => {"changed": false, "msg": "HTTP Error 404: Not Found", "status": 404, "url": "http://192.168.1.10"}

Command Executed
-bash-4.2$ ansible -i inventory/hosts.ini webservers -m uri -a "url=http://{{ ansible_host }} method=GET"

Output
web1 | SUCCESS => {"changed": false, "status": 200, "url": "http://192.168.1.10"}
web2 | SUCCESS => {"changed": false, "status": 200, "url": "http://192.168.1.11"}

Command Executed
-bash-4.2$ ansible -i inventory/hosts.ini webservers -m systemd -a "name=httpd" --become

Output
web1 | SUCCESS => {"changed": false, "name": "httpd", "state": "started", "status": "Active: active (running)"}
web2 | SUCCESS => {"changed": false, "name": "httpd", "state": "started", "status": "Active: active (running)"}

--------------------------------------------------------------------------------
Verify listening ports (netstat)
--------------------------------------------------------------------------------

Command Executed
-bash-4.2$ ansible -i inventory/hosts.ini webservers -m shell -a "netstat -tlnp | grep :80"

Output
web1 | FAILED | rc=127 >>
/bin/sh: netstat: command not found
web2 | FAILED | rc=127 >>
/bin/sh: netstat: command not found

Command Executed
-bash-4.2$ ansible -i inventory/hosts.ini webservers -m yum -a "name=net-tools state=present" --become

Output
web1 | SUCCESS => {"changed": true, "msg": "Installed: net-tools"}
web2 | SUCCESS => {"changed": true, "msg": "Installed: net-tools"}

Command Executed
-bash-4.2$ ansible -i inventory/hosts.ini webservers -m shell -a "netstat -tlnp | grep :80"

Output
web1 | CHANGED | rc=0 >>
tcp6       0      0 :::80                   :::*                    LISTEN      2157/httpd
web2 | CHANGED | rc=0 >>
tcp6       0      0 :::80                   :::*                    LISTEN      2109/httpd

--------------------------------------------------------------------------------
curl tests from control node
--------------------------------------------------------------------------------

Command Executed
-bash-4.2$ curl http://192.168.1.10

Output
<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>Welcome to web1</title>
...
 <h1>Welcome to web1</h1>
...
 <p><strong>IP Address:</strong> 192.168.1.10</p>
...
</html>

Command Executed
-bash-4.2$ curl http://192.168.1.11

Output
<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>Welcome to web2</title>
...
 <h1>Welcome to web2</h1>
...
 <p><strong>IP Address:</strong> 192.168.1.11</p>
...
</html>

================================================================================
Verification Playbook
================================================================================

Command Executed
-bash-4.2$ nano playbooks/verify-deployment.yml

Output

Command Executed
-bash-4.2$ ansible-playbook -i inventory/hosts.ini playbooks/verify-deployment.yml

Output
PLAY [Verify Web Server Deployment] *******************************************

TASK [Gathering Facts] ********************************************************
ok: [web1]
ok: [web2]

TASK [Check Apache service status] ********************************************
ok: [web1]
ok: [web2]

TASK [Verify Apache is listening on port 80] **********************************
ok: [web1]
ok: [web2]

TASK [Test HTTP response] *****************************************************
ok: [web1]
ok: [web2]

TASK [Test about page] ********************************************************
ok: [web1]
ok: [web2]

TASK [Check CSS file accessibility] *******************************************
ok: [web1]
ok: [web2]

TASK [Display verification results] *******************************************
ok: [web1] => {
  "msg": "Verification Results for web1:\n- Apache Service: active\n- Port 80 Status: Open\n- Main Page: OK\n- About Page: OK\n- CSS File: OK\n- Server URL: http://192.168.1.10\n"
}
ok: [web2] => {
  "msg": "Verification Results for web2:\n- Apache Service: active\n- Port 80 Status: Open\n- Main Page: OK\n- About Page: OK\n- CSS File: OK\n- Server URL: http://192.168.1.11\n"
}

PLAY RECAP ********************************************************************
web1                       : ok=8    changed=0    unreachable=0    failed=0
web2                       : ok=8    changed=0    unreachable=0    failed=0

================================================================================
Troubleshooting Commands Output
================================================================================

--------------------------------------------------------------------------------
Issue 1: SSH Connection Problems
--------------------------------------------------------------------------------

Command Executed
-bash-4.2$ ssh -i ~/.ssh/id_rsa ec2-user@192.168.1.10

Output
Last login: Tue Aug 20 12:18:44 2026 from 192.168.1.200
[ec2-user@web1 ~]$ exit
logout
Connection to 192.168.1.10 closed.

Command Executed
-bash-4.2$ ssh-add -l

Output
The agent has no identities.

Command Executed
-bash-4.2$ ssh-add ~/.ssh/id_rsa

Output
Identity added: /home/centos/.ssh/id_rsa (/home/centos/.ssh/id_rsa)

--------------------------------------------------------------------------------
Issue 2: Permission Denied Errors (sudo)
--------------------------------------------------------------------------------

Command Executed
-bash-4.2$ ansible -i inventory/hosts.ini webservers -m shell -a "sudo whoami"

Output
web1 | CHANGED | rc=0 >>
root
web2 | CHANGED | rc=0 >>
root

Command Executed
-bash-4.2$ cat inventory/hosts.ini

Output
[webservers]
web1 ansible_host=192.168.1.10 ansible_user=ec2-user
web2 ansible_host=192.168.1.11 ansible_user=ec2-user
[webservers:vars]
ansible_ssh_private_key_file=~/.ssh/id_rsa
ansible_ssh_common_args='-o StrictHostKeyChecking=no'

--------------------------------------------------------------------------------
Issue 3: Firewall Blocking Connections
--------------------------------------------------------------------------------

Command Executed
-bash-4.2$ ansible -i inventory/hosts.ini webservers -m shell -a "firewall-cmd --list-all" --become

Output
web1 | CHANGED | rc=0 >>
public (active)
  interfaces: eth0
  services: dhcpv6-client http ssh
  ports:
  rich rules:

web2 | CHANGED | rc=0 >>
public (active)
  interfaces: eth0
  services: dhcpv6-client http ssh
  ports:
  rich rules:

Command Executed
-bash-4.2$ ansible -i inventory/hosts.ini webservers -m firewalld -a "service=http permanent=yes state=enabled immediate=yes" --become

Output
web1 | SUCCESS => {"changed": false, "immediate": true, "permanent": true, "service": "http", "state": "enabled"}
web2 | SUCCESS => {"changed": false, "immediate": true, "permanent": true, "service": "http", "state": "enabled"}

--------------------------------------------------------------------------------
Issue 4: Apache Configuration Errors
--------------------------------------------------------------------------------

Command Executed
-bash-4.2$ ansible -i inventory/hosts.ini webservers -m shell -a "httpd -t" --become

Output
web1 | CHANGED | rc=0 >>
Syntax OK
web2 | CHANGED | rc=0 >>
Syntax OK

Command Executed
-bash-4.2$ ansible -i inventory/hosts.ini webservers -m shell -a "tail -20 /var/log/httpd/error_log" --become

Output
web1 | CHANGED | rc=0 >>
[Wed Aug 20 12:05:18.114230 2026] [mpm_event:notice] [pid 2157:tid 2157] AH00489: Apache/2.4.57 (Red Hat Enterprise Linux) configured -- resuming normal operations
[Wed Aug 20 12:05:18.114250 2026] [core:notice] [pid 2157:tid 2157] AH00094: Command line: '/usr/sbin/httpd -D FOREGROUND'

web2 | CHANGED | rc=0 >>
[Wed Aug 20 12:05:22.330101 2026] [mpm_event:notice] [pid 2109:tid 2109] AH00489: Apache/2.4.57 (Red Hat Enterprise Linux) configured -- resuming normal operations
[Wed Aug 20 12:05:22.330120 2026] [core:notice] [pid 2109:tid 2109] AH00094: Command line: '/usr/sbin/httpd -D FOREGROUND'
